<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../../">
  <title data-ice="title">src/test/supergroup_mocha.js | API Document</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  
  
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  <a href="./manual/index.html" data-ice="manualHeaderLink">Manual</a>
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <a data-ice="repoURL" href="https://github.com/Sigfried/supergroup.git" class="repo-url-github">Repository</a>
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  </ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">src/test/supergroup_mocha.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">&apos;use strict&apos;;

import assert from &apos;assert&apos;;
import vows from &apos;vows&apos;;
import _, {Supergroup, Value, ValueList} from &apos;../supergroup&apos;;
var suite = vows.describe(&quot;supergroup&quot;);

var gradeBook = [
  {lastName: &quot;Gold&quot;,    firstName: &quot;Sigfried&quot;, class: &quot;Remedial Programming&quot;,           grade: &quot;C&quot;, num: 2},
  {lastName: &quot;Gold&quot;,    firstName: &quot;Sigfried&quot;, class: &quot;Literary Posturing&quot;,             grade: &quot;B&quot;, num: 3},
  {lastName: &quot;Gold&quot;,    firstName: &quot;Sigfried&quot;, class: &quot;Documenting with Pretty Colors&quot;, grade: &quot;B&quot;, num: 3},
  {lastName: &quot;Sassoon&quot;, firstName: &quot;Sigfried&quot;, class: &quot;Remedial Programming&quot;,           grade: &quot;A&quot;, num: 3},
  {lastName: &quot;Androy&quot;,  firstName: &quot;Sigfried&quot;, class: &quot;Remedial Programming&quot;,           grade: &quot;B&quot;, num: 3}
];
//var gradesByLastName = _.supergroup(gradeBook, &apos;lastName&apos;);

var gradesByLastName = _.supergroup(gradeBook, &apos;lastName&apos;);

var gradesByName = _.supergroup(gradeBook, function(d) { 
  return d.firstName + &apos; &apos; + d.lastName; }, {dimName: &apos;fullName&apos;});

var gradesByGradeLastName = _.supergroup(gradeBook, [&apos;grade&apos;,&apos;lastName&apos;]);


suite.addBatch({
 &quot;supergroup state&quot;: {
  topic: gradesByGradeLastName.state(),
  /*
  &quot;should be a Supergroup State&quot;: function(selector) {
    assert.instanceOf(selector, _.stateClass);
  },
  &quot;should allow selection by value&quot;: function(selector) {
    selector.selectByVal(gradesByGradeLastName.lookup(&quot;A&quot;));
    assert.deepEqual(selector.selectedRecs(), [gradeBook[3]]);
  },
  &quot;should allow selection by filter&quot;: function(selector) {
    selector.selectByVal(gradesByGradeLastName.lookup(&quot;A&quot;));
    assert.deepEqual(selector.selectedRecs(), [gradeBook[3]]);
  },
  */
 }
});

suite.addBatch({
 &quot;supergroup general&quot;: {
  topic: function(){ return null; }, 
  &quot;rawValues are group names&quot;: function() {
    assert.deepEqual(gradesByLastName.rawValues(), [&quot;Gold&quot;,&quot;Sassoon&quot;,&quot;Androy&quot;]);
  },
  &quot;dimensions can be functions&quot;: function() {
    assert.deepEqual(gradesByName.rawValues(), [&quot;Sigfried Gold&quot;,&quot;Sigfried Sassoon&quot;,&quot;Sigfried Androy&quot;]);
  },
  &quot;multi-level supergroups have top-level rawValues&quot;: function() {
    assert.deepEqual(gradesByGradeLastName.rawValues().sort(), [&quot;A&quot;,&quot;B&quot;,&quot;C&quot;]);
  },
  &quot;multi-level supergroups have children&quot;: function() {
    assert.equal(gradesByGradeLastName[1]._hasChildren, true);
  },
  &quot;multi-level supergroups have second-level rawValues&quot;: function() {
    assert.deepEqual(gradesByGradeLastName[1].children.rawValues().sort(), [&quot;Androy&quot;,&quot;Gold&quot;]);
  },
  &quot;multi-level supergroups have Value at second-level&quot;: function() {
    assert.equal(gradesByGradeLastName[1].children[0] instanceof Value, true);
  },
  &quot;first group contains three raw records&quot;: function() {
    assert.deepEqual(gradesByLastName[0].records.slice(0), [
      {&quot;lastName&quot;:&quot;Gold&quot;,&quot;firstName&quot;:&quot;Sigfried&quot;,&quot;class&quot;:&quot;Remedial Programming&quot;,&quot;grade&quot;:&quot;C&quot;,&quot;num&quot;:2},
      {&quot;lastName&quot;:&quot;Gold&quot;,&quot;firstName&quot;:&quot;Sigfried&quot;,&quot;class&quot;:&quot;Literary Posturing&quot;,&quot;grade&quot;:&quot;B&quot;,&quot;num&quot;:3},
      {&quot;lastName&quot;:&quot;Gold&quot;,&quot;firstName&quot;:&quot;Sigfried&quot;,&quot;class&quot;:&quot;Documenting with Pretty Colors&quot;,&quot;grade&quot;:&quot;B&quot;,&quot;num&quot;:3}
    ]); 
  },
  &quot;lookup finds the right thing&quot;: function() {
    assert.equal(gradesByLastName.lookup(&quot;Sassoon&quot;).records[0], gradeBook[3])
  },
  &quot;two groups for &apos;B&apos;&quot;: function() {
    //console.log(&apos;lookup:&apos;, gradesByGradeLastName.lookup(&quot;B&quot;));
    assert.deepEqual(gradesByGradeLastName.lookup(&quot;B&quot;).children.rawValues(), [&quot;Gold&quot;,&quot;Androy&quot;]);
  },
  &quot;leafnodes on leaf returns ValueList&quot;: function() {
    let leafNodes = gradesByGradeLastName[1].leafNodes();
    assert.equal(leafNodes instanceof ValueList, true);
  },
  &quot;leafnodes on leaf returns Value&quot;: function() {
    let leafNodes = gradesByGradeLastName[1].children[0].leafNodes();
    assert.equal(leafNodes.length , 1);
    assert.equal(leafNodes[0] instanceof Value, true);
  },
  &quot;leafnodes on Value returns Values&quot;: function() {
    let leafNodes = gradesByGradeLastName[1].leafNodes();
    assert.equal(leafNodes.length , 2);
    assert.equal(leafNodes[0] instanceof Value, true);
  },
  &quot;leafnodes on Supergroup returns ValueList&quot;: function() {
    let leafNodes = gradesByGradeLastName.leafNodes();
    assert.deepEqual(leafNodes.rawValues(), [&quot;Gold&quot;,&quot;Androy&quot;]);
    assert.equal(leafNodes.length, 4);
    assert.equal(leafNodes instanceof ValueList, true);
  },
  &quot;leafnodes on supergroup returns Values&quot;: function() {
    let leafNode = gradesByGradeLastName.leafNodes()[0];
    console.log(`leafNode is Value: ${leafNode instanceof Value}, its a ${leafNode.constructor}, leafNode: ${leafNode}`);
    assert.equal(gradesByGradeLastName.leafNodes()[0] instanceof Value, true);
  },
  &quot;leafnodes&quot;: function() {
    assert.deepEqual(gradesByGradeLastName.leafNodes().namePaths(), 
        [&quot;C/Gold&quot;,&quot;B/Gold&quot;,&quot;B/Androy&quot;,&quot;A/Sassoon&quot;]);
  },
  &quot;sort&quot;: function() {
    assert.deepEqual(gradesByGradeLastName.leafNodes().sort(function(a,b){
          return a.namePath() &lt; b.namePath() ? -1 : 
              b.namePath() &lt; a.namePath() ? 1 : 0
        }).namePaths(),
      [ &apos;A/Sassoon&apos;, &apos;B/Androy&apos;, &apos;B/Gold&apos;, &apos;C/Gold&apos; ]);
  },
  /*
  &quot;sortBy&quot;: function() {
    assert.deepEqual(gradesByGradeLastName.leafNodes().sortBy(
          function(d){ return d.namePath(); }).namePaths(),
      [ &apos;A/Sassoon&apos;, &apos;B/Androy&apos;, &apos;B/Gold&apos;, &apos;C/Gold&apos; ]);
  },
  &quot;previous&quot;: function() {
    assert.deepEqual(gradesByGradeLastName.sort()[2].previous().namePath(),
          &quot;B&quot;);
  },
  &quot;vals should have rootList&quot;: function() {
    assert.equal(gradesByGradeLastName.lookup([&apos;A&apos;,&apos;Sassoon&apos;]).rootList(),
           gradesByGradeLastName);
  },
  */
 },
 /*
 &quot;asRootVal&quot;: {
  topic: function(){ 
    // make new version of gradesByGradeLastName so asRootVal doesn&apos;t mess up other one
    var gradesByGradeLastName = _.supergroup(gradeBook, [&apos;grade&apos;,&apos;lastName&apos;]);
    var root = gradesByGradeLastName.asRootVal();
    return {gradesByGradeLastName:gradesByGradeLastName, root:root};
  }, 
  &apos;should set its dimension as &quot;root&quot;&apos;: function(topic) {
    assert.equal(topic.root.dim, &apos;root&apos;);
  },
  &apos;should contain all the records&apos;: function(topic) {
    assert.equal(topic.root.aggregate(_.sum, &apos;num&apos;), 14);
  },
  &apos;should namePath to root&apos;: function(topic) {
    assert.deepEqual(topic.gradesByGradeLastName.leafNodes().namePaths(),
     [ &apos;Root/C/Gold&apos;,&apos;Root/B/Gold&apos;,&apos;Root/B/Androy&apos;,&apos;Root/A/Sassoon&apos; ]);
  }
  */
  /* haven&apos;t translated these yet

  describe(&apos;hierarchicalTableToTree&apos;, function() {
    var treePairs = [{&quot;p&quot;:&quot;animal&quot;,&quot;c&quot;:&quot;mammal&quot;},{&quot;p&quot;:&quot;animal&quot;,&quot;c&quot;:&quot;reptile&quot;},{&quot;p&quot;:&quot;animal&quot;,&quot;c&quot;:&quot;fish&quot;},{&quot;p&quot;:&quot;animal&quot;,&quot;c&quot;:&quot;bird&quot;},{&quot;p&quot;:&quot;bird&quot;,&quot;c&quot;:&quot;kiwi&quot;},{&quot;p&quot;:&quot;kiwi&quot;,&quot;c&quot;:&quot;orange tailed kiwi&quot;},{&quot;p&quot;:&quot;plant&quot;,&quot;c&quot;:&quot;tree&quot;},{&quot;p&quot;:&quot;plant&quot;,&quot;c&quot;:&quot;bush&quot;},{&quot;p&quot;:&quot;plant&quot;,&quot;c&quot;:&quot;grass&quot;},{&quot;p&quot;:&quot;plant&quot;,&quot;c&quot;:&quot;fruit&quot;},{&quot;p&quot;:&quot;fruit&quot;,&quot;c&quot;:&quot;kiwi&quot;},{&quot;p&quot;:&quot;kiwi&quot;,&quot;c&quot;:&quot;purple kiwi&quot;},{&quot;p&quot;:&quot;tree&quot;,&quot;c&quot;:&quot;oak&quot;},{&quot;p&quot;:&quot;tree&quot;,&quot;c&quot;:&quot;maple&quot;},{&quot;p&quot;:&quot;oak&quot;,&quot;c&quot;:&quot;pin oak&quot;},{&quot;p&quot;:&quot;mammal&quot;,&quot;c&quot;:&quot;primate&quot;},{&quot;p&quot;:&quot;mammal&quot;,&quot;c&quot;:&quot;bovine&quot;},{&quot;p&quot;:&quot;bovine&quot;,&quot;c&quot;:&quot;cow&quot;},{&quot;p&quot;:&quot;bovine&quot;,&quot;c&quot;:&quot;ox&quot;},{&quot;p&quot;:&quot;primate&quot;,&quot;c&quot;:&quot;monkey&quot;},{&quot;p&quot;:&quot;primate&quot;,&quot;c&quot;:&quot;ape&quot;},{&quot;p&quot;:&quot;ape&quot;,&quot;c&quot;:&quot;chimpanzee&quot;},{&quot;p&quot;:&quot;ape&quot;,&quot;c&quot;:&quot;gorilla&quot;},{&quot;p&quot;:&quot;ape&quot;,&quot;c&quot;:&quot;me&quot;}];
    var tree;
    it(&apos;should work with (data, parentProp, childProp) params&apos;, function() {
      tree = _.hierarchicalTableToTree(treePairs, &apos;p&apos;, &apos;c&apos;);
      expect(tree).toBeDefined();
    });
    it(&apos;should make this tree&apos;, function() {
      var paths = _.invoke(tree.flattenTree(), &apos;namePath&apos;);
      expect(paths).toEqual([&quot;animal&quot;, &quot;animal/mammal&quot;, &quot;animal/mammal/primate&quot;, &quot;animal/mammal/primate/monkey&quot;, &quot;animal/mammal/primate/ape&quot;, &quot;animal/mammal/primate/ape/chimpanzee&quot;, &quot;animal/mammal/primate/ape/gorilla&quot;, &quot;animal/mammal/primate/ape/me&quot;, &quot;animal/mammal/bovine&quot;, &quot;animal/mammal/bovine/cow&quot;, &quot;animal/mammal/bovine/ox&quot;, &quot;animal/reptile&quot;, &quot;animal/fish&quot;, &quot;animal/bird&quot;, &quot;animal/bird/kiwi&quot;, &quot;plant&quot;, &quot;plant/tree&quot;, &quot;plant/tree/oak&quot;, &quot;plant/tree/oak/pin oak&quot;, &quot;plant/tree/maple&quot;, &quot;plant/bush&quot;, &quot;plant/grass&quot;, &quot;plant/fruit&quot;, &quot;plant/fruit/kiwi&quot;, &quot;plant/fruit/kiwi/orange tailed kiwi&quot;, &quot;plant/fruit/kiwi/purple kiwi&quot;]);
    });
  });
 }
  */
});

suite.run();
/*
var test_data = [
  {&quot;person_id&quot;: &quot;0&quot;, &quot;domain_id&quot;: &quot;Condition&quot;, &quot;concept_name&quot;: &quot;Impacted cerumen&quot;, &quot;drug_era_start_date&quot;: &quot;2008-02-19&quot;, &quot;drug_era_end_date&quot;: &quot;2008-02-19&quot;},
  {&quot;person_id&quot;: &quot;0&quot;, &quot;domain_id&quot;: &quot;Condition&quot;, &quot;concept_name&quot;: &quot;Otogenic otalgia&quot;, &quot;drug_era_start_date&quot;: &quot;2008-02-19&quot;, &quot;drug_era_end_date&quot;: &quot;2008-02-19&quot;},
  {&quot;person_id&quot;: &quot;0&quot;, &quot;domain_id&quot;: &quot;Condition&quot;, &quot;concept_name&quot;: &quot;Acquired trigger finger&quot;, &quot;drug_era_start_date&quot;: &quot;2008-02-23&quot;, &quot;drug_era_end_date&quot;: &quot;2008-02-23&quot;},
  {&quot;person_id&quot;: &quot;0&quot;, &quot;domain_id&quot;: &quot;Drug&quot;, &quot;concept_name&quot;: &quot;Methylprednisolone&quot;, &quot;drug_era_start_date&quot;: &quot;2008-02-23&quot;, &quot;drug_era_end_date&quot;: &quot;2008-02-23&quot;},
  {&quot;person_id&quot;: &quot;0&quot;, &quot;domain_id&quot;: &quot;Condition&quot;, &quot;concept_name&quot;: &quot;Pes anserinus bursitis&quot;, &quot;drug_era_start_date&quot;: &quot;2008-02-23&quot;, &quot;drug_era_end_date&quot;: &quot;2008-02-23&quot;},
  {&quot;person_id&quot;: &quot;0&quot;, &quot;domain_id&quot;: &quot;Condition&quot;, &quot;concept_name&quot;: &quot;Benign essential hypertension&quot;, &quot;drug_era_start_date&quot;: &quot;2008-02-28&quot;, &quot;drug_era_end_date&quot;: &quot;2008-02-28&quot;},
  {&quot;person_id&quot;: &quot;0&quot;, &quot;domain_id&quot;: &quot;Condition&quot;, &quot;concept_name&quot;: &quot;Familial hyperchylomicronemia&quot;, &quot;drug_era_start_date&quot;: &quot;2008-02-28&quot;, &quot;drug_era_end_date&quot;: &quot;2008-02-28&quot;},
  {&quot;person_id&quot;: &quot;0&quot;, &quot;domain_id&quot;: &quot;Condition&quot;, &quot;concept_name&quot;: &quot;Hyperlipidemia&quot;, &quot;drug_era_start_date&quot;: &quot;2008-02-28&quot;, &quot;drug_era_end_date&quot;: &quot;2008-02-28&quot;},
  {&quot;person_id&quot;: &quot;0&quot;, &quot;domain_id&quot;: &quot;Condition&quot;, &quot;concept_name&quot;: &quot;Tachycardia&quot;, &quot;drug_era_start_date&quot;: &quot;2008-02-28&quot;, &quot;drug_era_end_date&quot;: &quot;2008-02-28&quot;},
  {&quot;person_id&quot;: &quot;0&quot;, &quot;domain_id&quot;: &quot;Condition&quot;, &quot;concept_name&quot;: &quot;Amblyopia&quot;, &quot;drug_era_start_date&quot;: &quot;2008-03-09&quot;, &quot;drug_era_end_date&quot;: &quot;2008-03-09&quot;},
  {&quot;person_id&quot;: &quot;0&quot;, &quot;domain_id&quot;: &quot;Condition&quot;, &quot;concept_name&quot;: &quot;Astigmatism&quot;, &quot;drug_era_start_date&quot;: &quot;2008-03-09&quot;, &quot;drug_era_end_date&quot;: &quot;2008-03-09&quot;},
  {&quot;person_id&quot;: &quot;0&quot;, &quot;domain_id&quot;: &quot;Condition&quot;, &quot;concept_name&quot;: &quot;Myopia&quot;, &quot;drug_era_start_date&quot;: &quot;2008-03-09&quot;, &quot;drug_era_end_date&quot;: &quot;2008-03-09&quot;},
  {&quot;person_id&quot;: &quot;0&quot;, &quot;domain_id&quot;: &quot;Condition&quot;, &quot;concept_name&quot;: &quot;Nonexudative age-related macular degeneration&quot;, &quot;drug_era_start_date&quot;: &quot;2008-03-09&quot;, &quot;drug_era_end_date&quot;: &quot;2008-03-09&quot;},
  {&quot;person_id&quot;: &quot;0&quot;, &quot;domain_id&quot;: &quot;Condition&quot;, &quot;concept_name&quot;: &quot;Malignant lymphoma of intra-abdominal lymph nodes&quot;, &quot;drug_era_start_date&quot;: &quot;2008-03-31&quot;, &quot;drug_era_end_date&quot;: &quot;2008-03-31&quot;},
  {&quot;person_id&quot;: &quot;0&quot;, &quot;domain_id&quot;: &quot;Drug&quot;, &quot;concept_name&quot;: &quot;pantoprazole&quot;, &quot;drug_era_start_date&quot;: &quot;2008-03-31&quot;, &quot;drug_era_end_date&quot;: &quot;2008-03-31&quot;},
  {&quot;person_id&quot;: &quot;0&quot;, &quot;domain_id&quot;: &quot;Condition&quot;, &quot;concept_name&quot;: &quot;Mobitz type II atrioventricular block&quot;, &quot;drug_era_start_date&quot;: &quot;2008-04-04&quot;, &quot;drug_era_end_date&quot;: &quot;2008-04-04&quot;},
  {&quot;person_id&quot;: &quot;0&quot;, &quot;domain_id&quot;: &quot;Condition&quot;, &quot;concept_name&quot;: &quot;Benign prostatic hypertrophy with outflow obstruction&quot;, &quot;drug_era_start_date&quot;: &quot;2008-04-24&quot;, &quot;drug_era_end_date&quot;: &quot;2008-04-24&quot;},
  {&quot;person_id&quot;: &quot;0&quot;, &quot;domain_id&quot;: &quot;Condition&quot;, &quot;concept_name&quot;: &quot;Chronic cystitis&quot;, &quot;drug_era_start_date&quot;: &quot;2008-04-24&quot;, &quot;drug_era_end_date&quot;: &quot;2008-04-24&quot;},
  {&quot;person_id&quot;: &quot;0&quot;, &quot;domain_id&quot;: &quot;Condition&quot;, &quot;concept_name&quot;: &quot;Chronic hepatitis C&quot;, &quot;drug_era_start_date&quot;: &quot;2008-04-24&quot;, &quot;drug_era_end_date&quot;: &quot;2008-04-24&quot;},
  {&quot;person_id&quot;: &quot;0&quot;, &quot;domain_id&quot;: &quot;Condition&quot;, &quot;concept_name&quot;: &quot;Acute pyelonephritis with medullary necrosis&quot;, &quot;drug_era_start_date&quot;: &quot;2008-05-08&quot;, &quot;drug_era_end_date&quot;: &quot;2008-05-08&quot;},
  {&quot;person_id&quot;: &quot;0&quot;, &quot;domain_id&quot;: &quot;Condition&quot;, &quot;concept_name&quot;: &quot;Urinary tract infectious disease&quot;, &quot;drug_era_start_date&quot;: &quot;2008-05-08&quot;, &quot;drug_era_end_date&quot;: &quot;2008-05-08&quot;},
  {&quot;person_id&quot;: &quot;0&quot;, &quot;domain_id&quot;: &quot;Condition&quot;, &quot;concept_name&quot;: &quot;Exudative age-related macular degeneration&quot;, &quot;drug_era_start_date&quot;: &quot;2008-05-20&quot;, &quot;drug_era_end_date&quot;: &quot;2008-05-20&quot;},
  {&quot;person_id&quot;: &quot;1494&quot;, &quot;domain_id&quot;: &quot;Condition&quot;, &quot;concept_name&quot;: &quot;Disorder of lipid metabolism&quot;, &quot;drug_era_start_date&quot;: &quot;2010-12-01&quot;, &quot;drug_era_end_date&quot;: &quot;2010-12-01&quot;},
  {&quot;person_id&quot;: &quot;1494&quot;, &quot;domain_id&quot;: &quot;Condition&quot;, &quot;concept_name&quot;: &quot;Open wound of foot except toes with complication&quot;, &quot;drug_era_start_date&quot;: &quot;2010-12-01&quot;, &quot;drug_era_end_date&quot;: &quot;2010-12-01&quot;},
  {&quot;person_id&quot;: &quot;1494&quot;, &quot;domain_id&quot;: &quot;Condition&quot;, &quot;concept_name&quot;: &quot;Peripheral vascular disease&quot;, &quot;drug_era_start_date&quot;: &quot;2010-12-01&quot;, &quot;drug_era_end_date&quot;: &quot;2010-12-01&quot;}];

var domcon = _.supergroup(test_data, [&apos;domain_id&apos;,&apos;concept_name&apos;]);
//var domcon = _.supergroup(person_eras, [&apos;domain_id&apos;]);
console.log(domcon.rawValues());
*/
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(0.4.3)</span></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
